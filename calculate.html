<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投资计算器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #calculator {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        label {
            display: block;
            margin-bottom: 8px;
        }

        input,
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 16px;
            box-sizing: border-box;
        }

        button {
            background-color: #4caf50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        #resultTextArea {
            width: 100%;
            height: 100px;
            margin-top: 16px;
            resize: none;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: Arial, sans-serif;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div id="calculator">
        <label for="count">每天投入次数：</label>
        <input type="number" id="count" placeholder="请输入每天投入次数" value="2" min="1">

        <label>选择投资天数或目标金额：</label>
        <select id="selector">
            <option name="selector" value="day" checked> 投资天数</option>
            <option name="selector" value="money">目标金额</option>
        </select>

        <!-- <label for="value">输入值：</label>
        <input type="number" id="value" placeholder="请输入对应的值" max="100"> -->


        <label>选择投资天数或目标金额：</label>
        <select id="selector" onchange="updateInputLabel()">
            <option name="selector" value="day" checked> 投资天数</option>
            <option name="selector" value="money">目标金额</option>
        </select>

        
        <label id="valueLabel" for="value">目标天数：</label>
        <input type="number" id="value" placeholder="请输入对应的值" max="100" min="1">

        <label for="initialAmount">初始账号金额：</label>
        <input type="number" id="initialAmount" placeholder="请输入初始账号金额">

        <button onclick="calculate()">计算</button>
        <!-- 新增的文本框用于展示结果 -->
        <textarea id="resultTextArea" readonly></textarea>
    </div>

    <script>


        function updateInputLabel() {
            const selector = document.querySelector('option[name="selector"]:checked');
            const valueLabel = document.getElementById('valueLabel');

            if (selector.value === 'day') {
                valueLabel.innerHTML = '目标天数：<span style="color: red;">请输入天数</span>';
            } else if (selector.value === 'money') {
                valueLabel.innerHTML = '目标金额：<span style="color: blue;">请输入目标金额</span>';
            }
        }

        function calculate() {
            const count = parseFloat(document.getElementById('count').value);
            const selector = document.querySelector('option[name="selector"]:checked');
            const value = parseFloat(document.getElementById('value').value);
            const initialAmount = parseFloat(document.getElementById('initialAmount').value);

            if (!count || !selector || !value || !initialAmount) {
                alert("请填写所有必填项！");
                return;
            }

            if (selector.value === 'day' && (value < 1 || value % 1 !== 0)) {
                alert("投资天数必须是正整数！");
                return;
            }

            if (selector.value === 'day' && (value < 1 || value > 100)) {
                alert("投资天数必须在 1 到 100 之间！");
                return;
            }
            if (selector.value === 'money' && (value < 1 || value > 1000000)) {
                alert("投资金额必须在 1 到 100W 之间！");
                return;
            }

            if (selector.value === 'day') {
                calculateMoney(count, value, 0, initialAmount);
            } else if (selector.value === 'money') {
                calculateMoney(count, 0, value, initialAmount);
            }
        }


        function calculateMoney(count, day, needMoney, x) {
            let res_message = ''
            if (day == 0) {
                console.log(`传入值 本金：${x}  每天投入次数：${count} 期望金额：${needMoney} `)
            } else {
                console.log(`传入值 本金：${x}  每天投入次数：${count}  投的天数：${day} `)
            }

            if (count > 10 || count > 100) {
                return;
            }
            if (x == 0) {
                return;
            }

            let y = 0;
            let z = 0;
            let lastDay = 0;
            let lastCountSum = 0;

            if (day == null || day == 0) {
                day = 999
            }

            for (let dayItem = 1; dayItem <= day; dayItem++) {
                for (let countItem = 1; countItem <= count; countItem++) {
                    let oldX = x;
                    y = Math.floor(x / 100);
                    z = Math.floor(y * 1.98) - y;
                    x = x + z;
                    console.log(`第${dayItem}天，第${countItem}次投入时的账户金额：${oldX}`);
                    console.log(`第${dayItem}天，第${countItem}次投入金额：${y}`);
                    console.log(`第${dayItem}天，第${countItem}次投入挣的钱：${z}`);
                    console.log(`第${dayItem}天，第${countItem}次投入挣钱之后的账号余额：${x}`);

                    if (x >= needMoney) {
                        lastCountSum = (dayItem - 1) * count + countItem;
                        break;
                    }
                }

                if (x >= needMoney) {
                    lastDay = dayItem;
                    break;
                }
            }
            res_message = `一共需要投资${lastDay}天，投资${lastCountSum}次的账号余额：${x}`
            console.log(res_message);

            // 修改结果显示方式
            if (String(res_message).length > 0) {
                document.getElementById('resultTextArea').value = res_message;
                alert(res_message);
            }

        }

    </script>
</body>

</html>